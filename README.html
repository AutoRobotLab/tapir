<!doctype html>
<html>
<head>
<meta charset="utf-8">
<style>
h1,
h2,
h3,
h4,
h5,
h6,
p,
blockquote {
    margin: 0;
    padding: 0;
}
body {
    font-family: "Helvetica Neue", Helvetica, "Hiragino Sans GB", Arial, sans-serif;
    font-size: 13px;
    line-height: 18px;
    color: #737373;
    margin: 10px 10px 10px 20px;
}
a {
    color: #0069d6;
}
a:hover {
    color: #0050a3;
    text-decoration: none;
}
a img {
    border: none;
}
p {
    margin-bottom: 9px;
}
h1,
h2,
h3,
h4,
h5,
h6 {
    color: #404040;
    line-height: 36px;
}
h1 {
    margin-bottom: 18px;
    font-size: 30px;
}
h2 {
    font-size: 24px;
}
h3 {
    font-size: 18px;
}
h4 {
    font-size: 16px;
}
h5 {
    font-size: 14px;
}
h6 {
    font-size: 13px;
}
hr {
    margin: 0 0 19px;
    border: 0;
    border-bottom: 1px solid #aaa;
}
blockquote {
    padding: 13px 13px 21px 15px;
    margin-bottom: 18px;
    font-family:georgia,serif;
    font-style: italic;
}
blockquote:before {
    content:"\201C";
    font-size:40px;
    margin-left:-10px;
    font-family:georgia,serif;
    color:#eee;
}
blockquote p {
    font-size: 14px;
    font-weight: 300;
    line-height: 18px;
    margin-bottom: 0;
    font-style: italic;
}
code, pre {
    padding: 0 3px 2px;
    font-family: Monaco, Andale Mono, Courier New, monospace;
    -webkit-border-radius: 3px;
    -moz-border-radius: 3px;
    border-radius: 3px;
}
code {
    background-color: #fee9cc;
    color: rgba(0, 0, 0, 0.75);
    padding: 1px 3px;
    font-size: 12px;
}
pre {
    display: block;
    padding: 14px;
    margin: 0 0 18px;
    line-height: 16px;
    font-size: 11px;
    border: 1px dashed #ccc;
    border: 1px dashed rgba(0, 0, 0, 0.15);
    -webkit-border-radius: 3px;
    -moz-border-radius: 3px;
    border-radius: 3px;
    white-space: pre;
    white-space: pre-wrap;
    word-wrap: break-word;
}
pre code {
    background-color: #fdfdfd;
    color:#737373;
    font-size: 11px;
}
@media screen and (min-width: 768px) {
    body {
        width: 748px;
        margin:10px auto;
    }
}
</style>
<title>README.html</title>
</head>
<body>
<h1>Toolkit for approximating and Adapting POMDP solutions In Realtime (TAPIR)</h1>

<p>TAPIR is a C++ implementation of the Adaptive Belief Tree (ABT) algorithm [1].
ABT is an online POMDP solver capable of adapting to modifications to the POMDP
model without the need to reconstruct the policy from scratch.</p>

<p>[1] H. Kurniawati and V. Yadav. An Online POMDP Solver for Uncertainty Planning
in Dynamic Environment. Proc. Int. Symp. on Robotics Research. 2013.
http://robotics.itee.uq.edu.au/~hannakur/dokuwiki/papers/isrr13_abt.pdf</p>

<p>For bug reports and suggestions, please email rdl.algorithm@itee.uq.edu.au</p>

<p>For information on updates, please visit http://robotics.itee.uq.edu.au/~tapir</p>

<hr />

<h2>TAPIR Development Team</h2>

<ul>
<li>Main developer: Dimitri Klimenko</li>
<li>ROS + VREP interface: Joshua Song</li>
</ul>


<hr />

<h2>System Requirements</h2>

<p>Operating systems: Linux.</p>

<p>Building and running the C++ source code requires:</p>

<ul>
<li><a href="https://gcc.gnu.org">GNU C++ compiler</a> (>= 4.8) or equivalent</li>
<li><a href="http://libspatialindex.github.io">libspatialindex</a> (>= 1.7.0)
  Debian/Ubuntu package name: &ldquo;libspatialindex-dev&rdquo;</li>
</ul>


<p><strong>Ubuntu 12.04 NOTE:</strong></p>

<p>Ubuntu 12.04 by default ships with g++ 4.6. One option is to replace g++ 4.6 with g++ 4.8. Otherwise, to have both g++ 4.8 and g++ 4.6:</p>

<pre><code>sudo add-apt-repository ppa:ubuntu-toolchain-r/test
sudo apt-get update
sudo apt-get install g++-4.8
sudo update-alternatives --install /usr/bin/g++ g++ /usr/bin/g++-4.8 60
sudo update-alternatives --install /usr/bin/g++ g++ /usr/bin/g++-4.6 40
</code></pre>

<p>Here, 4.8 priority is set to 60, higher than 4.6. To swap to 4.6 use:</p>

<pre><code>sudo update-alternatives --config g++
</code></pre>

<hr />

<h2>Quick Start (Command-line Interface)</h2>

<p>TAPIR with command-line interface has been tested with Ubuntu 12.04 &mdash; 14.04.</p>

<h3>Setup and Installation</h3>

<p>At the top level directory of TAPIR (where this README file is located), run:</p>

<pre><code>make all
</code></pre>

<p>or, for faster compilation via multi-threading,</p>

<pre><code>make all -jN
</code></pre>

<p>where N is the number of threads you want to use &ndash; 8 is a good choice on many
CPUs.</p>

<p>This will create the executables for a command-line interface for each of
the example problems &ndash; these are created in problems/[problem-name],
and also in src/problems/[problem-name] for convenience while editing the
source files.</p>

<h3>Running</h3>

<p>After compiling, you can try the following commands to try using TAPIR on
RockSample, which is a well-known example POMDP:</p>

<pre><code>cd problems/rocksample
./solve
./simulate
</code></pre>

<p>You can also runRockSample[11, 11], a version of RockSample with a larger
map and much larger state space, by using the command-line setting
<code>--cfg default-11-11.cfg</code>, i.e.</p>

<pre><code>cd problems/rocksample
./solve --cfg default-11-11.cfg
./simulate --cfg default-11-11.cfg
</code></pre>

<p>The command &ldquo;solve&rdquo; uses the parameters set in a problem-specific
configuration file, which for RockSample is, by default,
<a href="problems/rocksample/default.cfg">here</a>.
The purpose of &ldquo;solve&rdquo; is to output a policy, which by default will be
written to the file &ldquo;pol.pol&rdquo; in the current working directory.</p>

<p>The command &ldquo;simulate&rdquo; uses the same default configuration file, but its
function is to run online simulations to evaluate the performance of
the TAPIR solver. It starts by loading an initial policy from the policy
file (default &ldquo;pol.pol&rdquo;, as output by &ldquo;solve&rdquo;), and runs a step-by step
simulation of the POMDP. The online solver is run on every step so that
the policy can be dynamically generated on every step.</p>

<h3>Changing Configuration Files</h3>

<p>To change the configuration settings, edit the default configuration
files, or copy them and make your own version, e.g.</p>

<pre><code>cd problems/rocksample
cp default.cfg my_settings.cfg
</code></pre>

<p>Now you can edit my_settings.cfg to change the settings. To use
with a different configuration file, use the command-line argument
&mdash;cfg, e.g.</p>

<pre><code>cd problems/rocksample
./solve --cfg my_settings.cfg
</code></pre>

<p>Note that &ldquo;solve&rdquo; is still searching for configuration settings in
the directory &ldquo;problems/rocksample&rdquo; &ndash; you can change this by using the argument
&mdash;base-path <path>.</p>

<h3>Other Options</h3>

<p>Some of the core settings can also be set via command-line arguments. Any
command-line options given will override the values specified in the
configuration file. For details, run</p>

<pre><code>./solve --help
</code></pre>

<p>or</p>

<pre><code>./simulate --help
</code></pre>

<p>to see the command-line options for either executable.</p>

<hr />

<h2>Quick Start (ROS and V-REP Interface)</h2>

<p>TAPIR provides an interface with ROS and V-REP, tested on:</p>

<ul>
<li>Ubuntu 12.04 with ROS Hydro + V-REP PRO EDU V3.1.2.</li>
<li>Ubuntu 14.04 with ROS Indigo + V-REP PRO EDU V3.1.2.</li>
</ul>


<h3>Additional system requirements:</h3>

<h5><a href="http://wiki.ros.org/hydro/Installation/Ubuntu">ROS</a>.</h5>

<p>We have tested with ROS Hydro on Ubuntu 12.04 and with ROS Indigo on Ubuntu 14.04.
Some possible issues and ways around them are:</p>

<p><strong>Ubuntu 12.04 NOTE:</strong></p>

<p>ROS Hydro defaults to using Boost 1.46 instead of Boost 1.48, and the Boost 1.48 headers are incompatible with C++11 (as used by TAPIR). To resolve this issue, you will need to install Boost 1.48 from source. The easiest way to set up Boost 1.48 for use with ROS and TAPIR is:</p>

<p>At the top level directory of TAPIR (where this README file is located):</p>

<pre><code>Set CUSTOM_BOOST_148_DIR in the [root Makefile](./Makefile) to the location of your Boost 1.48 installation, or, if you haven't installed it yet, the desired directory for it. 
make boost
</code></pre>

<p>The command <code>make boost</code> will find if a Boost installation is in <code>CUSTOM_BOOST_148_DIR</code>. If it doesn&rsquo;t find Boost installation, it will automatically download Boost and install it to the directory you&rsquo;ve specified at <code>CUSTOM_BOOST_148_DIR</code>. It will also patch the bug of compiling Boost 1.48 with GCC >= 4.7.0. These processes are done by several scripts in the <a href="./.ros-scripts">.ros-scripts</a> directory.</p>

<p>If you wish to compile Boost 1.48 manually with GCC >= 4.7.0, you should use
the patch provided <a href="https://svn.boost.org/trac/boost/ticket/6165">here</a></p>

<p><strong>Ubuntu 14.04 NOTE:</strong></p>

<p>On Ubuntu 14.04 you must instead use ROS Indigo, which is available via the package &ldquo;ros-indigo-desktop-full&rdquo;</p>

<h5><a href="http://www.coppeliarobotics.com/downloads.html">V-REP</a></h5>

<p>Download V-REP and extract it to the directory of your choice. We have tested with V-REP PRO EDU V3.1.2. Some possible issues and ways around them are:</p>

<p><strong>Ubuntu 14.04 NOTE:</strong></p>

<p>On Ubuntu 14.04 the version of the ROS plugin that ships with V-REP will not work out of the box &ndash; it causes a segmentation fault in V-REP! You will need to recompile it yourself, by following the tutorial at http://www.coppeliarobotics.com/helpFiles/en/rosTutorialHydro.htm but with one major difference:</p>

<pre><code>You will need to change line 14 of the CMakeLists.txt in [V-REP root directory]/programming/ros_packages/vrep_plugin/ to 
`link_directories("/opt/ros/indigo/lib")` 
instead of 
`link_directories("/opt/ros/hydro/lib")`
</code></pre>

<h3>Setup and installation</h3>

<p>This package is designed to be used with the ROS Catkin build system, and as
such must be compiled within a Catkin workspace. To this end, at the top level
directory of TAPIR (where this README file is located):</p>

<pre><code>Set the following variables in [root Makefile](./Makefile)
- CUSTOM_BOOST_148_DIR - A custom path to Boost 1.48; leave this empty if you just want to use your system default version of Boost.
- ROS_SCRIPT - path to the main ROS setup script; the default is `/opt/ros/hydro/setup.sh`
- CATKIN_WS_DIR - path to the desired Catkin workspace directory; the default is `../catkin_ws` (relative to the root tapir directory, i.e. the location of this README.md)
- VREP_DIR - path to where you have extracted V-REP; the default is `../vrep`

Run the command make ros
</code></pre>

<p>The command make ros can automatically set up a workspace for you and
will add a symbolic link to the source directory into the workspace.</p>

<h3>Running</h3>

<p>If you compiled with <code>make ros</code>, TAPIR will automatically create a script
to run the Tag example problem together with the ROS and V-REP interface. To run tag with ROS+VREP,
from  the top level directory of TAPIR (where this README file is located), do:</p>

<pre><code>cd problems/tag
./simulate-ros
</code></pre>

<p>The script `simulate-ros' will automatically run a <em>roscore</em>, and then launch V-REP (if it is not already running). Note that the roscore must already be running when you start V-REP, or the ROS plugin will fail to load; it is also important to read the console messages when V-REP is staring up in order to make sure that the ROS plugin loads correctly. If there is an issue with loading the ROS plugin, you may need to recompile the plugin. Please read the V-REP ROS plugin tutorial at http://www.coppeliarobotics.com/helpFiles/en/rosTutorialHydro.htm</p>

<p>If you run a roscore and launch V-REP manually, and have sourced the setup script for your Catkin workspace, i.e.</p>

<pre><code>source [path/to/catkin/workspace]/devel/setup.bash
</code></pre>

<p>you can simply run</p>

<pre><code>roslaunch tapir tag.launch
</code></pre>

<p>in order to start the Tag problem.</p>

<p>After a couple of seconds, the simulation should start automatically; it can
also be paused at any time via the V-REP interface. During the simulation you
can also actively manipulate the environment using the mouse to left-click on
squares in the Tag grid:</p>

<ul>
<li>To remove an obstacle, left-click on a cell and wait momentarily.</li>
<li>To add an obstacle, left-click on a cell and wait momentarily.</li>
<li>You can also add or remove multiple cells at the same time by holding down
the CTRL key while clicking on those cells.</li>
</ul>


<h3>Source code notes</h3>

<p>The ROS/V-REP interface for Tag can be found in <a href="src/problems/tag/ros/TagVrep.cpp">TagVrep.cpp</a>. This interface uses the TAPIR <a href="src/solver/Simulator.hpp">Simulator</a> class in order to run the core simulation and generate the POMDP transitions and observations; this is done according to the <a href="src/problems/tag/TagModel.hpp">Tag problem model</a>.</p>

<hr />

<h2>Implementing a new POMDP model</h2>

<p>To create a new POMDP model and use it with the the command-line interface,</p>

<ol>
<li>Read the <a href="docs/README-MakeNewModel.html">README on implementing a new model</a>.</li>
<li>Create a new subdirectory for your POMDP in
<a href="src/problems">the problems directory</a>.</li>
<li>Implement all the required classes, as per <a href="docs/README.md">the overview</a></li>
<li>Add a new Makefile to your problem directory &ndash; just copy
<a href="src/problems/tag/Makefile">the Tag Makefile</a> and change MODULE_NAME to match
your new problem.</li>
<li>Add your problem to the CHILD_DIRS variable in the
<a href="src/problems/Makefile">problems Makefile</a></li>
<li>Create a new subdirectory in <a href="problems">the config directory</a> for your
problem, and add any required configuration files there.</li>
<li>Compile your code via &ldquo;make [problem-name]&rdquo;, or simply by running &ldquo;make&rdquo; from
your new subdirectory of src/problems, e.g.
<code>
cd src/problems/tag
make
</code></li>
</ol>


<hr />

<h2>Package Structure</h2>

<p>Here&rsquo;s a quick overview of the contents of this package, by directory structure:</p>

<ul>
<li>README.md &ndash; this README!</li>
<li><a href="./Makefile">Makefile</a> &ndash; used to change most of the core settings used
in building the code.</li>
<li><a href="./.make">.make</a> &ndash; contains template Makefile code which is included by
the Makefiles in many of the subdirectories. This is the core of the build
system, which is described in the <a href=".make/README.md">Build System README</a>.</li>
<li><a href="./problems">problems</a> &ndash; contains problem-specific configuration settings, and
is also the default output directory for all of the problem executables.

<ul>
<li><a href="problems/rocksample">RockSample</a> &ndash; contains configuration settings for
RockSample. This is also the default place for the generated executables
for RockSample to go to.</li>
<li><a href="problems/tag">Tag</a> &ndash; contains configuration settings for Tag; the
generated executables for Tag will go here.</li>
</ul>
</li>
<li><a href="./docs">docs</a> &ndash; contains <a href="docs/README.md">a detailed overview</a>, as well
as Doxygen settings in order to generate
<a href="docs/html/index.html">HTML documentation</a>.

<ul>
<li><a href="docs/html">html</a> &ndash; the output directory for HTML documentation</li>
</ul>
</li>
<li><a href="./src">src</a> &ndash; the source directory

<ul>
<li><a href="src/solver">solver</a> &ndash; the core ABT solver source code</li>
<li><a href="src/options">options</a> &ndash; contains code for parsing configuration options.
Most of the work is done by two libraries included in the code:

<ul>
<li><a href="src/options/tclap">TCLAP</a> &ndash; see http://tclap.sourceforge.net/ for
more details.</li>
<li><a href="src/options/inih">inih</a> &ndash; see https://code.google.com/p/inih/ for
more details.</li>
</ul>
</li>
<li><a href="src/problems">problems</a> &ndash; contains the code for all of the example
problems.

<ul>
<li><a href="src/problems/shared">shared</a> &ndash; contains shared code used by many
problems</li>
<li><a href="src/problems/rocksample">RockSample</a> &ndash; contains code for the
RockSample POMDP.</li>
<li><a href="src/problems/tag">Tag</a> &ndash; contains code for the Tag POMDP.</li>
</ul>
</li>
</ul>
</li>
</ul>


<h3>ROS-related directories</h3>

<p>Some of the files and directories are specifically used for the ROS interface,
and hence are not needed if you are not using TAPIR with ROS. These are:</p>

<ul>
<li><a href="./CMakeLists.txt">CMakelists.txt</a> &ndash; This allows TAPIR to be used as a ROS
package &ndash; it is not used by the standard build system for TAPIR.</li>
<li><a href="./launch">launch</a> &ndash; This contains launch files to be used by ROS, in order
to conveniently launch specific scenarios.</li>
<li><a href="./msg">msg</a> &ndash; Describes ROS messages, which are published by ROS nodes; this
allows a simple publish-subscribe model for one-way communication.</li>
<li><a href="./srv">srv</a> &ndash; Describes ROS services, which allow communication with a
request-reply model.</li>
<li><a href="./.ros-scripts">.ros-scripts</a> &ndash; Some scripts for extra convenience in working
with ROS.</li>
</ul>


<hr />

<h2>Acknowledgements</h2>

<p>The development of this package is partially funded by the University of Queensland BEE Division Grant 2013.</p>

<hr />

<h2>Release Notes</h2>
</body>
</html>